# üéØ RustMaps Parser

–í—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä –∫–∞—Ä—Ç —Å —Å–∞–π—Ç–∞ rustmaps.ru, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ TypeScript. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –≤—Å–µ –∫–∞—Ä—Ç—ã –∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏—Ö —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üöÄ **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–æ 50 –∫–∞—Ä—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- üé≠ **–£–º–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Puppeteer –¥–ª—è –æ–±—Ö–æ–¥–∞ JavaScript-–∑–∞—â–∏—Ç—ã
- üîÑ **–°–∏—Å—Ç–µ–º–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- üìä **–ü—Ä–æ–≥—Ä–µ—Å—Å –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏** - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- üìù **–ú–∞–Ω–∏—Ñ–µ—Å—Ç –∫–∞—Ä—Ç** - JSON-—Ñ–∞–π–ª —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –≤—Å–µ—Ö –∫–∞—Ä—Ç
- üé® **–ö—Ä–∞—Å–∏–≤—ã–µ –ª–æ–≥–∏** - —Ü–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
- ‚ö° **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ–Ω—É–∂–Ω—ã—Ö CSS/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- üíæ **–£–º–Ω–æ–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤

## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Node.js 18.0.0 –∏–ª–∏ –≤—ã—à–µ
- npm –∏–ª–∏ yarn

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/your-username/rustmaps-parser.git
cd rustmaps-parser

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–æ–µ–∫—Ç
npm run build

# –ó–∞–ø—É—Å–∫–∞–µ–º –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
npm run web

# –ò–ª–∏ –∑–∞–ø—É—Å–∫–∞–µ–º –ø–∞—Ä—Å–µ—Ä –≤ CLI —Ä–µ–∂–∏–º–µ
npm start scan
```

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ npm (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

```bash
npm install -g rustmaps-parser
rustmaps-parser --help
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ù–æ–≤–∏–Ω–∫–∞!)

```bash
# –ó–∞–ø—É—Å–∫ –≤–µ–±-–±—Ä–∞—É–∑–µ—Ä–∞ –∫–∞—Ä—Ç
npm run web

# –ó–∞–ø—É—Å–∫ –Ω–∞ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É
npm start web --port 8080
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:3000` –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å —É–¥–æ–±–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º!

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:**
- üñ•Ô∏è –ö—Ä–∞—Å–∏–≤—ã–π –±—Ä–∞—É–∑–µ—Ä –≤—Å–µ—Ö –∫–∞—Ä—Ç –≤ –≤–∏–¥–µ –∫–∞—Ä—Ç–æ—á–µ–∫
- üîç –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –æ–ø–∏—Å–∞–Ω–∏—é –∏ —Ç–µ–≥–∞–º
- üìÑ –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–∞–∂–¥–æ–π –∫–∞—Ä—Ç–µ
- ‚¨áÔ∏è –ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Facepunch API
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ø–∞–≥–∏–Ω–∞—Ü–∏—è
- üì± –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

### –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞

```bash
# –°–∫–∞—á–∞—Ç—å –≤—Å–µ –∫–∞—Ä—Ç—ã –≤ –ø–∞–ø–∫—É ./downloads
npm start scan

# –°–∫–∞—á–∞—Ç—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
npm start scan -- --output ./my-maps
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `npm run web` | –ó–∞–ø—É—Å–∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) |
| `npm start scan` | –†–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ |
| `npm start monitor` | –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ |
| `npm start stats` | –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–µ—à–∞ |
| `npm start reset` | –°–±—Ä–æ—Å–∏—Ç—å –∫–µ—à –∑–∞–≥—Ä—É–∑–æ–∫ |
| `npm start test-facepunch` | –¢–µ—Å—Ç Facepunch API |

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|----------|--------------|
| `-o, --output <path>` | –ü–∞–ø–∫–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è | `./output` |
| `-p, --port <port>` | –ü–æ—Ä—Ç –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ | `3000` |
| `-i, --interval <min>` | –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–º–∏–Ω—É—Ç—ã) | `60` |

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
# –ó–∞–ø—É—Å–∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–±)
npm run web

# –ó–∞–ø—É—Å–∫ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –Ω–∞ –ø–æ—Ä—Ç—É 8080
npm start web --port 8080

# CLI: —Ä–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
npm start scan

# CLI: –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞–∂–¥—ã–π —á–∞—Å
npm start monitor --interval 60

# CLI: –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
npm start stats

# CLI: —Å–±—Ä–æ—Å –∫–µ—à–∞ –∏ –ø–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
npm start reset
npm start scan
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
rustmaps-parser/
‚îú‚îÄ‚îÄ src/                     # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ core/               # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ browser.ts      # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—Ä–∞—É–∑–µ—Ä–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ parsers/            # –ü–∞—Ä—Å–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mapParser.ts    # –ü–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ä—Ç
‚îÇ   ‚îú‚îÄ‚îÄ downloader/         # –°–∫–∞—á–∏–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ fileDownloader.ts
‚îÇ   ‚îú‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.ts       # –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config/             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ defaults.ts     # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
‚îÇ   ‚îú‚îÄ‚îÄ types/              # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ dist/                   # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥
‚îú‚îÄ‚îÄ downloads/              # –°–∫–∞—á–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
‚îî‚îÄ‚îÄ package.json
```

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install

# –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π
npm run dev

# –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build

# –õ–∏–Ω—Ç–∏–Ω–≥ –∫–æ–¥–∞
npm run lint

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
npm run format

# –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
npm run clean
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü–∞—Ä—Å–µ—Ä –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ:

1. **BrowserManager** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Puppeteer, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. **MapParser** - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ä—Ç, –æ–±—Ö–æ–¥ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
3. **FileDownloader** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –æ—à–∏–±–æ–∫
4. **Logger** - –∫—Ä–∞—Å–∏–≤—ã–π –≤—ã–≤–æ–¥ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
5. **CLI** - —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- **–°–∫–æ—Ä–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞**: ~100 –∫–∞—Ä—Ç/–º–∏–Ω—É—Ç–∞
- **–°–∫–æ—Ä–æ—Å—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è**: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ concurrency
- **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏**: ~150MB –ø—Ä–∏ concurrency=10
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–≤—Ç–æ—Ä—ã —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ CSS/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü
- –ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
- –£–º–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- Graceful shutdown –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π

## üìã –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

```
downloads/
‚îú‚îÄ‚îÄ maps_manifest.json       # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤—Å–µ—Ö –∫–∞—Ä—Ç
‚îú‚îÄ‚îÄ 12345_Custom_Map.map     # –§–∞–π–ª—ã –∫–∞—Ä—Ç
‚îú‚îÄ‚îÄ 12346_Awesome_Map.zip
‚îî‚îÄ‚îÄ ...
```

### –§–æ—Ä–º–∞—Ç –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞

```json
{
  "created": "2024-01-15T10:30:00.000Z",
  "total": 1500,
  "maps": [
    {
      "mid": "12345",
      "title": "Custom Map",
      "description": "Amazing custom map",
      "url": "https://rustmaps.ru/index.php?mode=map&mid=12345",
      "downloadUrl": "https://rustmaps.ru/download.php?id=12345",
      "hasDownloadUrl": true
    }
  ]
}
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –≠—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑—É–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ concurrency (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è ‚â§20)
- –ù–µ –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª—è–π—Ç–µ —á–∞—Å—Ç–æ—Ç–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤
- –°–æ–±–ª—é–¥–∞–π—Ç–µ —É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∞–π—Ç–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã —Ç–æ–ª—å–∫–æ –≤ –ª–∏—á–Ω—ã—Ö —Ü–µ–ª—è—Ö

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
- –°–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ç–∞–π–º–∞—É—Ç—ã
- –û—à–∏–±–∫–∏ JavaScript –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–∞—Ä—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
- –°–∞–π—Ç –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è Chrome/Chromium –¥–ª—è Puppeteer

## ü§ù –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

1. Fork —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ feature branch: `git checkout -b feature/amazing-feature`
3. Commit –∏–∑–º–µ–Ω–µ–Ω–∏—è: `git commit -m 'Add amazing feature'`
4. Push –≤ branch: `git push origin feature/amazing-feature`
5. –û—Ç–∫—Ä–æ–π—Ç–µ Pull Request

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–∞–π–ª–µ [LICENSE](LICENSE)

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã

- [rustmaps.py](https://pypi.org/project/rustmaps.py/) - Python wrapper –¥–ª—è rustmaps.com
- [huntmap-parser](https://github.com/interlark/huntmap-parser) - –ü–∞—Ä—Å–µ—Ä huntmap.ru

## ‚≠ê –ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç

–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫—É ‚≠ê –Ω–∞ GitHub!

---

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ Rust**

# RustMaps Parser

üó∫Ô∏è Automated parser for rustmaps.ru that downloads Rust maps, uploads them to Facepunch API, and sends Discord notifications.

## Features

- üîç **Stream Processing** - Parses, downloads, uploads, and notifies in real-time
- üì• **Smart Caching** - Tracks downloaded files to avoid duplicates
- üöÄ **Facepunch Integration** - Uploads maps to official Facepunch API
- üì§ **Discord Notifications** - Sends notifications with Facepunch URLs only
- üåê **Russian to Latin** - Transliterates Russian filenames for compatibility
- ü§ñ **GitHub Actions** - Automated parsing every 6 hours

## Installation

```bash
# Clone repository
git clone <your-repo-url>
cd rustmaps-parser

# Install dependencies
npm install

# Build project
npm run build
```

## Configuration

### Environment Variables

Create a `.env` file or set environment variables:

```bash
# Discord webhook URL (required for notifications)
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR_WEBHOOK_URL

# Enable Facepunch API uploads (required)
FACEPUNCH_UPLOAD_ENABLED=true

# Optional: Delete local files after Facepunch upload
DELETE_LOCAL_AFTER_UPLOAD=false

# Optional network configuration
# Base URL override for rustmaps
# RUSTMAPS_BASE_URL=https://rustmaps.ru
# Force HTTP fallback even if HTTPS fails preflight
# FORCE_HTTP_FALLBACK=false
# Network timeout in ms (shared across axios and Puppeteer default)
# NETWORK_TIMEOUT_MS=15000
# Concurrency and retries
# CONCURRENCY=3
# RETRY_ATTEMPTS=2
# Headless mode for Puppeteer (true/false)
# HEADLESS=true
# Custom user agent for both browser and HTTP requests
# USER_AGENT=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36

# Proxy configuration (auto-detected via proxy-agent)
# HTTP_PROXY=http://user:pass@host:port
# HTTPS_PROXY=http://user:pass@host:port
# ALL_PROXY=socks5://host:port
# NO_PROXY=localhost,127.0.0.1

# Optional: force rustmaps.ru IPv4 mapping for browser (host-resolver-rules)
# RUSTMAPS_IPV4=185.185.124.28
```

### GitHub Actions Setup

1. **Add Repository Secrets:**
   - Go to your repository ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions
   - Add secret: `DISCORD_WEBHOOK_URL` with your Discord webhook URL

2. **Enable Actions:**
   - Go to Actions tab and enable workflows
   - The parser will run automatically every 6 hours

3. **Manual Trigger:**
   - Go to Actions ‚Üí Parse RustMaps ‚Üí Run workflow

## Usage

### Local Commands

```bash
# Single scan
npm start scan

# Continuous monitoring (every 60 minutes)
npm start monitor --interval 60

# Show cache statistics
npm start stats

# Reset download cache
npm start reset

# Test Facepunch API upload
npm start test-facepunch
```

### GitHub Actions Workflow

The automated workflow:
1. üîç Parses rustmaps.ru for new maps
2. üì• Downloads .map files (not committed to Git)
3. üöÄ Uploads to Facepunch API
4. üì§ Sends Discord notifications with Facepunch URLs
5. üíæ Updates and commits `rustmaps-cache.json`

## File Structure

```
rustmaps-parser/
‚îú‚îÄ‚îÄ src/                    # Source code
‚îú‚îÄ‚îÄ output/                 # Output directory
‚îÇ   ‚îú‚îÄ‚îÄ rustmaps-cache.json # Cache file (tracked in Git)
‚îÇ   ‚îî‚îÄ‚îÄ *.map              # Map files (ignored by Git)
‚îú‚îÄ‚îÄ .github/workflows/      # GitHub Actions
‚îî‚îÄ‚îÄ dist/                   # Built JavaScript
```

## Cache System

- **Tracked in Git:** `output/rustmaps-cache.json`
- **Ignored by Git:** `output/*.map` files
- **Purpose:** Prevents re-downloading same files across runs

## Discord Integration

- Only sends notifications for maps with Facepunch URLs
- Includes map title, ID, tags, and Facepunch download link
- Sends scan summaries with statistics

## Facepunch API

- Uploads .map files to official Facepunch API
- Generates safe filenames with Russian transliteration
- Provides reliable download URLs for Discord

## Development

```bash
# Watch mode for development
npm run dev

# Build for production
npm run build

# Run tests
npm test
```

## Troubleshooting

### GitHub Actions Issues

1. **Workflow not running:**
   - Check if Actions are enabled in repository settings
   - Verify cron schedule syntax

2. **Discord notifications not working:**
   - Ensure `DISCORD_WEBHOOK_URL` secret is set correctly
   - Test webhook URL manually

3. **Facepunch uploads failing:**
   - Check if `FACEPUNCH_UPLOAD_ENABLED=true` is set
   - Verify .map files are being generated

### Local Issues

1. **Browser errors:**
   ```bash
   # Install Chromium dependencies (Ubuntu/Debian)
   sudo apt-get install -y libnss3 libatk-bridge2.0-0 libdrm2 libxkbcommon0
   ```

2. **Permission errors:**
   ```bash
   # Fix output directory permissions
   chmod 755 output/
   ```

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Test locally
5. Submit a pull request

## License

MIT License - see LICENSE file for details. 